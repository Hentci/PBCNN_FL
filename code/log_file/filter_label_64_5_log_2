64 5
2023-07-05 18:49:17.584285: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2023-07-05 18:49:17.625304: E tensorflow/stream_executor/cuda/cuda_driver.cc:313] failed call to cuInit: CUDA_ERROR_NO_DEVICE: no CUDA-capable device is detected
2023-07-05 18:49:17.625333: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:169] retrieving CUDA diagnostic information for host: user-SYS-7049GP-TRT
2023-07-05 18:49:17.625339: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:176] hostname: user-SYS-7049GP-TRT
2023-07-05 18:49:17.625419: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:200] libcuda reported version is: 470.199.2
2023-07-05 18:49:17.625438: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:204] kernel reported version is: 470.182.3
2023-07-05 18:49:17.625444: E tensorflow/stream_executor/cuda/cuda_diagnostics.cc:313] kernel version 470.182.3 does not match DSO version 470.199.2 -- cannot find working devices in this configuration
2023-07-05 18:49:17.625682: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2023-07-05 18:49:17.651587: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 3000000000 Hz
2023-07-05 18:49:17.656591: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f5724000b60 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2023-07-05 18:49:17.656613: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
WARNING:tensorflow:SparseFeature is a complicated feature config and should only be used after careful consideration of VarLenFeature.
W0705 18:49:17.787959 140023591462080 parsing_config.py:563] SparseFeature is a complicated feature config and should only be used after careful consideration of VarLenFeature.
WARNING:tensorflow:From /home/sage/.conda/envs/PBCNN_v2/lib/python3.7/site-packages/tensorflow/python/ops/parsing_config.py:719: sparse_merge (from tensorflow.python.ops.sparse_ops) is deprecated and will be removed in a future version.
Instructions for updating:
No similar op available at this time.
W0705 18:49:17.790690 140023591462080 deprecation.py:323] From /home/sage/.conda/envs/PBCNN_v2/lib/python3.7/site-packages/tensorflow/python/ops/parsing_config.py:719: sparse_merge (from tensorflow.python.ops.sparse_ops) is deprecated and will be removed in a future version.
Instructions for updating:
No similar op available at this time.
train ds size:  41486
WARNING:tensorflow:SparseFeature is a complicated feature config and should only be used after careful consideration of VarLenFeature.
W0705 18:59:48.200257 140023591462080 parsing_config.py:563] SparseFeature is a complicated feature config and should only be used after careful consideration of VarLenFeature.
valid ds size:  5743
tf.Tensor(
[10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10
 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10
 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10
 10 10 10 10 10 10  3 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10
 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10
 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10
 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10  7 10 10 10 10
 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10
 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10
 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10
 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10], shape=(256,), dtype=int64)
tf.Tensor(
[10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10
 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10
 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10
 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10
 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10
 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10
 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10
 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10
 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10
  1 10 10 10 10 10 10 10 10 10 10 10 10 10 10  1 10 10 10 10 10 10 10 10
 10 10  1 10 10 10 10 10 10 10 10 10 10 10 10 10], shape=(256,), dtype=int64)
tf.Tensor(
[10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10
 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10
 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10
 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10
 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10
 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10
 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10
 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10
 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10
 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10
 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10], shape=(256,), dtype=int64)

Initializing Input DS:   0%|          | 0/10 [00:00<?, ?client/s]2023-07-05 19:01:42.263566: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:184] Filling up shuffle buffer (this may take a while): 5181 of 41486
2023-07-05 19:01:52.262506: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:184] Filling up shuffle buffer (this may take a while): 13974 of 41486
2023-07-05 19:02:02.260887: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:184] Filling up shuffle buffer (this may take a while): 21345 of 41486
2023-07-05 19:02:08.009939: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:233] Shuffle buffer filled.

Initializing Input DS:  10%|█         | 1/10 [01:07<10:07, 67.51s/client]
Initializing Input DS: 100%|██████████| 10/10 [01:07<00:00,  6.75s/client]
Epoch 0/3
client  0
2023-07-05 19:02:22.076761: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:184] Filling up shuffle buffer (this may take a while): 13252 of 41486
2023-07-05 19:02:32.073951: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:184] Filling up shuffle buffer (this may take a while): 22487 of 41486
2023-07-05 19:02:42.074455: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:184] Filling up shuffle buffer (this may take a while): 29929 of 41486
2023-07-05 19:02:52.070924: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:184] Filling up shuffle buffer (this may take a while): 37856 of 41486
2023-07-05 19:02:52.868913: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:233] Shuffle buffer filled.
Epoch 0, step 4148, avg loss 0.002807, avg acc 0.999245
client  1
Epoch 0, step 4148, avg loss 0.002779, avg acc 0.999249
client  2
Epoch 0, step 4148, avg loss 0.002665, avg acc 0.999230
client  3
Epoch 0, step 4148, avg loss 0.002553, avg acc 0.999293
client  4
Epoch 0, step 4148, avg loss 0.002554, avg acc 0.999313
client  5
Epoch 0, step 4148, avg loss 0.002810, avg acc 0.999240
client  6
Epoch 0, step 4148, avg loss 0.002678, avg acc 0.999242
client  7
Epoch 0, step 4148, avg loss 0.002601, avg acc 0.999273
client  8
Epoch 0, step 4148, avg loss 0.002820, avg acc 0.999249
client  9
Epoch 0, step 4148, avg loss 0.002715, avg acc 0.999257
Global model ===> VALID avg loss: 3635545.668963, avg acc: 0.999874
Epoch 1/3
client  0
Epoch 1, step 4148, avg loss 196335.963115, avg acc 0.999905
client  1
Epoch 1, step 4148, avg loss 159839.793214, avg acc 0.999903
client  2
Epoch 1, step 4148, avg loss 229045.645371, avg acc 0.999894
client  3
Epoch 1, step 4148, avg loss 180421.696209, avg acc 0.999904
client  4
Epoch 1, step 4148, avg loss 180803.585101, avg acc 0.999903
client  5
Epoch 1, step 4148, avg loss 209793.179544, avg acc 0.999901
client  6
Epoch 1, step 4148, avg loss 212128.182082, avg acc 0.999896
client  7
Epoch 1, step 4148, avg loss 200500.150494, avg acc 0.999899
client  8
Epoch 1, step 4148, avg loss 179625.595709, avg acc 0.999905
client  9
Epoch 1, step 4148, avg loss 122964.984631, avg acc 0.999895
Global model ===> VALID avg loss: 7680225113310835.000000, avg acc: 0.999927
Epoch 2/3
client  0
Epoch 2, step 4148, avg loss 565424125348983.500000, avg acc 0.999930
client  1
Epoch 2, step 4148, avg loss 444222378315124.250000, avg acc 0.999932
client  2
Epoch 2, step 4148, avg loss 710533901671950.375000, avg acc 0.999920
client  3
Epoch 2, step 4148, avg loss 504521149211516.687500, avg acc 0.999927
client  4
Epoch 2, step 4148, avg loss 544494021289950.437500, avg acc 0.999935
client  5
Epoch 2, step 4148, avg loss 631624622791921.875000, avg acc 0.999922
client  6
Epoch 2, step 4148, avg loss 628864695905732.625000, avg acc 0.999918
client  7
Epoch 2, step 4148, avg loss 580085104934122.000000, avg acc 0.999918
client  8
Epoch 2, step 4148, avg loss 542525253788651.250000, avg acc 0.999931
client  9
Epoch 2, step 4148, avg loss 275237654201994.750000, avg acc 0.999917
Global model ===> VALID avg loss: 32750066910479729691721728.000000, avg acc: 0.999928
2023-07-05 20:29:27.771659: W tensorflow/python/util/util.cc:329] Sets are not currently considered sequences, but this may change in the future, so consider avoiding using them.
WARNING:tensorflow:From /home/sage/.conda/envs/PBCNN_v2/lib/python3.7/site-packages/tensorflow/python/ops/resource_variable_ops.py:1817: calling BaseResourceVariable.__init__ (from tensorflow.python.ops.resource_variable_ops) with constraint is deprecated and will be removed in a future version.
Instructions for updating:
If using Keras pass *_constraint arguments to layers.
W0705 20:29:28.237005 140023591462080 deprecation.py:506] From /home/sage/.conda/envs/PBCNN_v2/lib/python3.7/site-packages/tensorflow/python/ops/resource_variable_ops.py:1817: calling BaseResourceVariable.__init__ (from tensorflow.python.ops.resource_variable_ops) with constraint is deprecated and will be removed in a future version.
Instructions for updating:
If using Keras pass *_constraint arguments to layers.
I0705 20:29:28.464252 140023591462080 64_5_run.py:642] After training 3 epochs, save model to bytes_64_num_5_pbcnn/models_tf, train logs to bytes_64_num_5_pbcnn/train_history.pkl.
WARNING:tensorflow:No training configuration found in save file, so the model was *not* compiled. Compile it manually.
W0705 20:29:29.088836 140023591462080 load.py:128] No training configuration found in save file, so the model was *not* compiled. Compile it manually.
QQ
WARNING:tensorflow:SparseFeature is a complicated feature config and should only be used after careful consideration of VarLenFeature.
W0705 20:29:29.100916 140023591462080 parsing_config.py:563] SparseFeature is a complicated feature config and should only be used after careful consideration of VarLenFeature.
/home/sage/.conda/envs/PBCNN_v2/lib/python3.7/site-packages/sklearn/metrics/_classification.py:2128: UserWarning: labels size, 11, does not match size of target_names, 15
  len(labels), len(target_names)
dict_keys(['ftp-bruteforce', 'ddos-hoic', 'dos-goldeneye', 'ddos-loic-http', 'sql-injection', 'dos-hulk', 'bot', 'ssh-bruteforce', 'bruteforce-xss', 'dos-slowhttptest', 'bruteforce-web', 'accuracy', 'macro avg', 'weighted avg'])
(0.976978, 0.976978, 0.956346, 0.964675, {
  'ftp-bruteforce': {'precision': 0.9788499669530734, 'recall': 1.0, 'f1-score': 0.9893119572478289, 'support': 1481}, 
  'ddos-hoic': {'precision': 1.0, 'recall': 1.0, 'f1-score': 1.0, 'support': 16163}, 
  'dos-goldeneye': {'precision': 0.9753547423450336, 'recall': 0.9546783625730995, 'f1-score': 0.9649057997783524, 'support': 1368}, 
  'ddos-loic-http': {'precision': 0.997518760590656, 'recall': 1.0, 'f1-score': 0.9987578392462204, 'support': 16483}, 
  'sql-injection': {'precision': 1.0, 'recall': 0.9951790633608816, 'f1-score': 0.9975837072833966, 'support': 1452}, 
  'dos-hulk': {'precision': 0.9995084787417056, 'recall': 0.9990174404323262, 'f1-score': 0.9992628992628992, 'support': 8142}, 
  'bot': {'precision': 0.9645535105657805, 'recall': 0.9985885673959068, 'f1-score': 0.9812760055478503, 'support': 1417}, 
  'ssh-bruteforce': {'precision': 0.9705497382198953, 'recall': 1.0, 'f1-score': 0.9850547990700764, 'support': 1483}, 
  'bruteforce-xss': {'precision': 0.8968023255813954, 'recall': 0.8727015558698727, 'f1-score': 0.8845878136200717, 'support': 707}, 
  'dos-slowhttptest': {'precision': 0.9636363636363636, 'recall': 0.6996699669966997, 'f1-score': 0.8107074569789675, 'support': 303}, 
  'bruteforce-web': {'precision': 0.9999788819776514, 'recall': 0.9999739355427876, 'f1-score': 0.9999764087541027, 'support': 5256200}, 
 
  'macro avg': {'precision': 0.9769775244192321, 'recall': 0.9563462629246885, 'f1-score': 0.9646749715263424, 'support': 5305199}, 
  'weighted avg': {'precision': 0.9999248246772396, 'recall': 0.9999251677458282, 'f1-score': 0.9999235711383759, 'support': 5305199}})
I0705 20:49:28.170880 140023591462080 64_5_run.py:672] cost: 120.17646851142247 min
